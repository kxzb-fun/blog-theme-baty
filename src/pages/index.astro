---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import Hero from "@components/Hero.astro";
import PostCard from "@components/PostCard.tsx";

import getSortedPosts from "@utils/getSortedPost";

const posts = await getCollection("posts");
const sortedPosts = getSortedPosts(posts);

const recentPosts = sortedPosts.filter(({ data }) => !data.featured);
// console.log(recentPosts[0]);
---

<Layout>
  <Hero />
  <Header />
  <main id="main-content">
    {
      recentPosts.length > 0 && (
        <section id="recent-posts">
          <h2>Recent Posts</h2>
          <ul>
            {recentPosts.map(
              ({ data, slug }, index) =>
                index < 4 && (
                  <PostCard href={`/posts/${slug}/`} frontmatter={data} />
                )
            )}
          </ul>
        </section>
      )
    }
  </main>

  <Footer />
</Layout>

<style></style>
